# Cursor Support Ticket - Terminal Issue (English)

**Topic:** https://forum.cursor.com/t/connection-error-serialize-binary/148894/3

**Request ID:** `af8369f5-0104-4a3a-aa97-e456ced56ac5`

---

## Problem Description

After the latest Cursor update, the integrated terminal in my project stopped working correctly with the Agent (PowerShell). **Current behaviour:** the command is executed (sometimes the IDE retries it up to 3 times), but the **IDE does not receive the command output** — see "Update (current behaviour)" at the end of this document. Previously, clearing `%APPDATA%\Cursor\User\workspaceStorage\` helped temporarily, but now **it doesn't help** — terminals break immediately after the update/launch.

In parallel, an **Internal Error** popup appears in the chat UI, and I see an error in the logs/stack:
`[internal] serialize binary: invalid int 32: 3221226505`

## Environment

- **OS**: Windows 10 (10.0.22631)
- **Shell**: PowerShell
- **Workspace**: `C:\Projects\PhotoSorter` (git repo)
- **Terminal**: integrated terminal in Cursor
- **Request ID**: `af8369f5-0104-4a3a-aa97-e456ced56ac5`

## Steps to Reproduce

1. Launch Cursor
2. Open workspace `C:\Projects\PhotoSorter`
3. Open integrated terminal (PowerShell)
4. Execute any simple command (e.g., `Get-Date` or any other)

## Actual Result

- **(Initially)** Commands in terminal didn't execute / terminal became unresponsive; **Internal Error** popup; stack trace (see below).
- **(Current)** Command **does** execute (IDE may retry it up to 3 times), but **IDE/Agent does not see the command output** — feedback from terminal to Cursor is broken.
- Clearing `%APPDATA%\Cursor\User\workspaceStorage\` no longer restores functionality.

## Expected Result

- Terminal executes commands stably
- No Internal Error in Cursor chat when working with terminal/agent

## Error Stack Trace

**Request ID:** `af8369f5-0104-4a3a-aa97-e456ced56ac5`

```
[internal] serialize binary: invalid int 32: 3221226505
LTe: [internal] serialize binary: invalid int 32: 3221226505
    at kmf (vscode-file://vscode-app/c:/Program%20Files/cursor/resources/app/out/vs/workbench/workbench.desktop.main.js:9095:38337)
    at Cmf (vscode-file://vscode-app/c:/Program%20Files/cursor/resources/app/out/vs/workbench/workbench.desktop.main.js:9095:37240)
    at $mf (vscode-file://vscode-app/c:/Program%20Files/cursor/resources/app/out/vs/workbench/workbench.desktop.main.js:9096:4395)
    at ova.run (vscode-file://vscode-app/c:/Program%20Files/cursor/resources/app/out/vs/workbench/workbench.desktop.main.js:9096:8170)
    at async qyt.runAgentLoop (vscode-file://vscode-app/c:/Program%20Files/cursor/resources/app/out/vs/workbench/workbench.desktop.main.js:34190:57047)
    at async Wpc.streamFromAgentBackend (vscode-file://vscode-app/c:/Program%20Files/cursor/resources/app/out/vs/workbench/workbench.desktop.main.js:34239:7695)
    at async Wpc.getAgentStreamResponse (vscode-file://vscode-app/c:/Program%20Files/cursor/resources/app/out/vs/workbench/workbench.desktop.main.js:34239:8436)
    at async FTe.submitChatMaybeAbortCurrent (vscode-file://vscode-app/c:/Program%20Files/cursor/resources/app/out/vs/workbench/workbench.desktop.main.js:9170:14575)
    at async Oi (vscode-file://vscode-app/c:/Program%20Files/cursor/resources/app/out/vs/workbench/workbench.desktop.main.js:32991:3808)
```

## Stack Trace Analysis

The error stack indicates a **problem in Cursor's JavaScript code** (not in the user's environment):

1. **All calls originate from Cursor's compiled JS code:**
   - `vscode-file://vscode-app/c:/Program%20Files/cursor/resources/app/out/vs/workbench/workbench.desktop.main.js`
   - This is Cursor's frontend bundle (Electron/VSCode-based application)

2. **Error in binary data serialization:**
   - `serialize binary: invalid int 32: 3221226505`
   - The value `3221226505` exceeds the maximum value for int32 (`2,147,483,647`)
   - This indicates **overflow** or incorrect value during data serialization

3. **Call context:**
   - `qyt.runAgentLoop` → `Wpc.streamFromAgentBackend` → `FTe.submitChatMaybeAbortCurrent`
   - Error occurs during agent/chat operation, likely when transferring data between frontend and backend

**Conclusion:** This is a bug in Cursor's code — during binary data serialization (likely when exchanging data with agent/terminal), a value is passed that doesn't fit into int32. This could be:
- Overflow during calculations
- Incorrect handling of terminal data
- Serialization bug introduced in the update

## What I've Already Tried

- **Full cleanup** of `%APPDATA%\Cursor\User\workspaceStorage\` and Cursor restart — **didn't help** (previously helped temporarily)
- **Switching to Command Prompt** (as suggested in the forum thread) — **didn't help**, the issue persists with any terminal
- The problem appeared **immediately after the latest Cursor update**

## Additional Information

The issue occurs with **any command** in the terminal, not just Python commands. Even simple PowerShell commands like `Get-Date` or `Get-Location` cause the terminal to break and trigger the Internal Error.

The error value `3221226505` is different from the one mentioned in the forum thread (`4294967295`), but both exceed int32 limits, suggesting a similar underlying issue.

## Request to Support

1. Confirm if the issue with `serialize binary: invalid int 32: 3221226505` and integrated terminal / Agent behaviour after update is known.
2. **Current symptom:** command runs in terminal but **output is not passed back to the IDE/Agent** (Agent retries ~3 times, never sees result). Please check serialization/pipe of terminal output to Agent.
3. Suggest which **additional logs** to collect and where to attach them (e.g., from `%APPDATA%\Cursor\logs\`) to help quickly identify the root cause.
4. If there's a temporary workaround (terminal/PTY/shell integration settings) — provide exact steps.

I can provide a screenshot of the **Internal Error** popup and any logs/dumps you specify.

---

**Note:** The problem appeared after the latest Cursor update. Previously, clearing workspaceStorage temporarily solved the issue, but now it doesn't help.

---

## Update (current behaviour)

**As of now**, the behaviour has changed:

- The **command does execute** (e.g. in the real terminal/process).
- The **IDE / Agent tries to run the command about 3 times** (retries).
- The **IDE does not see the result** — output from the terminal is not passed back to the chat/agent, so the agent thinks the command failed or didn't run, and may retry.

So the failure is no longer "terminal doesn't run commands" but **"terminal runs the command, yet the IDE/agent does not receive the command output"** (broken feedback from terminal to Cursor). The `serialize binary: invalid int 32` (or related) error likely happens when Cursor tries to read/serialize the terminal output to send to the agent.
