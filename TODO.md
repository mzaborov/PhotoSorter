- [ ] Разобраться, что делать с папкой `disk:/Фото/Технологии` (фото по работе): включать ли в правила, отдельная цепочка, или исключить.
- [ ] Добавить поддержку папки Фотокамера как входного источника (копировать новые фото в структуру внутри Фото, не удаляя оригиналы)
- [ ] Реализовать автоматическое обновление access token по refresh token для Яндекс.Диска
- [ ] Автозапуск Web-сервера (uvicorn) на Windows: ярлык/батник и/или Планировщик задач, запуск в фоне.

## План на завтра

- [ ] /faces: сделать закладки второго уровня в **no_faces** (группировка/фильтры по локации и времени).
- [ ] Подтянуть авто‑сортировку ближе к ручной разметке (**manual + gold**), особенно по котам (сейчас почти все попадают в no_faces).
- [ ] Начать различать людей на лицах (MVP: ручная привязка лица к персоне/кластеризация и UI для назначения).
- [ ] Сделать логику сортировки файлов по папкам на основе разметки + добавить кнопки для удаления мусора.

## Видео

- [ ] Определить поведение для видео в пайплайне: отдельная папка `_video` vs детект на кадрах (и как это отражать в UI/метриках).
- [ ] Извлечение кадров из видео: стратегия (например 1 кадр/сек или N кадров по длительности), лимиты и таймауты.
- [ ] Детект на кадрах (YuNet/YOLO) и агрегация результата в итоговую категорию для видео (faces/no_faces/animals/quarantine).
- [ ] Превью видео в UI (минимум: thumbnail/первый кадр + длительность).
- [ ] Метрики по видео отдельно (сколько видео, сколько с лицами/котов, “мимо gold” если появится gold для видео).
- [ ] Step0: битые видео отправлять в `_broken_media` и показывать счётчики/примеры причин.

## Ближайшее (после завершения прогона 21)

- [ ] Снять статистику по котам/лицам для `pipeline_run_id=21` (сравнить с 20): /gold → Отчёты → Статистика прогонов, плюс отчёты по `cats_gold`/`faces_gold` при необходимости.

## Видео (MVP: 3 кадра + разметка)

- [ ] Подготовить запуск `run=22` с видео: включение обработки видео (1–3 кадра) в пайплайне и прокидывание параметра из Web UI.
- [ ] /faces: dbl-click по видео → модалка с вкладками **Видео / Кадр 1 / Кадр 2 / Кадр 3** + fullscreen.
- [ ] /faces: разметка лиц для видео — обязательна для всех 3 кадров (сохранение прямоугольников для каждого кадра).
- [ ] /gold: просмотр (без редактирования) видео + 3 кадра, с preview и dbl-click как на /faces.
- [ ] API: выдача JPEG кадра видео по таймкоду (для кадров 1/2/3).
- [ ] DB: хранение разметки видео-кадров (run-scoped) для всех 3 кадров.
- [ ] /gold: кнопки **“Обновить gold из базы”** и **“Заполнить ручную разметку из gold”** — поддержать видео (включая перенос разметки 3 кадров).
